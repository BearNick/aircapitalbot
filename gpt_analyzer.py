import openai

# üîê –í—Å—Ç–∞–≤—å —Å–≤–æ–π –∫–ª—é—á –Ω–∏–∂–µ
API_KEY = ""

def analyze_model_with_gpt(user_inputs: dict, metrics: dict) -> str:
    prompt = (
    "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–ª–µ–¥—É—é—â–∏–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ä–∞—Å—á—ë—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –º–æ–¥–µ–ª–∏ —Å—Ç–∞—Ä—Ç–∞–ø–∞.\n"
    "–û–±—Ä–∞—Ç–∏ –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ:\n"
    "- –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –≥–æ—Ä–∏–∑–æ–Ω—Ç (horizon) –∑–∞–¥–∞—ë—Ç—Å—è –≤ **–≥–æ–¥–∞—Ö**, –Ω–µ –≤ –º–µ—Å—è—Ü–∞—Ö;\n"
    "- –≤—Å–µ —Å—É–º–º—ã —É–∫–∞–∑–∞–Ω—ã –≤ **—Ä—É–±–ª—è—Ö**;\n"
    "- –≤—ã—Ä—É—á–∫–∞ –∏ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã **–≤ –≥–æ–¥–æ–≤–æ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–∏**, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–Ω–æ–µ;\n"
    "- –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî **–≥–æ–¥–æ–≤—ã–µ**.\n\n"
    "üîß –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n" +
    "\n".join([f"{k}: {v}" for k, v in user_inputs.items()]) +
    "\n\nüìä –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:\n" +
    "\n".join([f"{k}: {v}" for k, v in metrics.items()]) +
    "\n\nüß† –í—ã–ø–æ–ª–Ω–∏ –∫—Ä–∞—Ç–∫–∏–π (5‚Äì7 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π), –Ω–æ —Å—Ç—Ä–æ–≥–∏–π –∞–Ω–∞–ª–∏–∑ –º–æ–¥–µ–ª–∏, –≤–∫–ª—é—á–∞—é—â–∏–π:\n"
    "- –û—Ü–µ–Ω–∫—É –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–π –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ NPV, IRR, —Å—Ä–æ–∫–∞ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏;\n"
    "- –í—ã—è–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤ –∏ —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç –º–æ–¥–µ–ª–∏;\n"
    "- –ö—Ä–∞—Ç–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø—Ä–æ–µ–∫—Ç–∞;\n"
    "- –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–Ω—ã–º–∏, –±–µ–∑ –æ–±—â–∏—Ö —Ñ—Ä–∞–∑.\n"
    "–ü–∏—à–∏ —Å—Ç—Ä–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –≤ –¥–µ–ª–æ–≤–æ–º —Å—Ç–∏–ª–µ."
)

    try:
        client = openai.OpenAI(api_key=API_KEY)  # ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—ë–º –∫–ª—é—á

        response = client.chat.completions.create(
    model="gpt-3.5-turbo",  # ‚úÖ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∏ –¥–æ—Å—Ç—É–ø–Ω–∞—è –º–æ–¥–µ–ª—å
    messages=[
        {"role": "system", "content": "–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫."},
        {"role": "user", "content": prompt}
    ],
    temperature=0.4
)

        return response.choices[0].message.content.strip()

    except Exception as e:
        return f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ GPT:\n\n{str(e)}"
